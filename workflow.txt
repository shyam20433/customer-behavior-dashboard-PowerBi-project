customer behaviour dashboard creation

downloaded dataset from Kaggle 

https://www.kaggle.com/datasets/zeesolver/consumer-behavior-and-shopping-habits-dataset/data


data cleaningusing python pandas 

step 1 imported the dataset 
step 2 counted missing values 
step 3 null values in review rating add values  by filling each category of the review rating by median 
       each catergory have different median so it is efficient 
step 4 snake casing 
       converting all cases to lower cases 
	replaced " " with _
step 5 split age into 4 groups
	young adult middle aged senior

step 6 converting frequency of purchases to numerical values 

step 7 removed promo code because discount applied and promo code used are equal in all rows so removed

step 8 created a new cleaned csv file named final_customer.behavior 


imported the data into postgres sql 

created a customer stage with all data types as text 
create another table customer and add data type and copied all the datas from the customer stage 


DROP TABLE IF EXISTS public.customer_stage;

CREATE TABLE public.customer_stage (
    customer_id TEXT,
    age TEXT,
    gender TEXT,
    item_purchased TEXT,
    category TEXT,
    purchase_amount TEXT,
    location TEXT,
    size TEXT,
    color TEXT,
    season TEXT,
    review_rating TEXT,
    subscription_status TEXT,
    shipping_type TEXT,
    discount_applied TEXT,
    previous_purchases TEXT,
    payment_method TEXT,
    frequency_of_purchases TEXT,
    age_group TEXT,
    purchase_frequency_days TEXT
);

INSERT INTO public.customer (
    customer_id, age, gender, item_purchased, category,
    purchase_amount, location, size, color, season,
    review_rating, subscription_status, shipping_type,
    discount_applied, previous_purchases, payment_method,
    frequency_of_purchases, age_group, purchase_frequency_days
)
SELECT
    customer_id::BIGINT,
    age::INT,
    gender,
    item_purchased,
    category,
    purchase_amount::BIGINT,
    location,
    size,
    color,
    season,
    review_rating::NUMERIC(3,1),
    subscription_status,
    shipping_type,
    CASE
        WHEN discount_applied ILIKE 'yes' THEN TRUE
        WHEN discount_applied ILIKE 'no'  THEN FALSE
        ELSE NULL
    END,
    previous_purchases::INT,
    payment_method,
    frequency_of_purchases,
    age_group,
    NULLIF(purchase_frequency_days, '')::NUMERIC(10,1)::INT
FROM public.customer_stage;



solved 9 query statements 

select * from customer limit 10


--SQL QUERIES 

--1.what is the total revenue generated by male vs female customers?


select gender,SUM(purchase_amount) as revenue 
from customer
group by gender

--2. which customer used a discount but still spent more than the average amount?


select customer_id,purchase_amount
from customer where discount_applied='yes' and 
purchase_amount>= (select AVG(purchase_amount)
from customer)


--3. which are the top 5 products with the highest average review rating ?


select item_purchased,ROUND(AVG(review_rating),2) 
from customer group by item_purchased order by 
AVG(review_rating) desc limit 5


--4. compare the average purchase amount between stand and express shipping?


select shipping_type,ROUND(AVG(purchase_amount),2)
from customer where shipping_type in ('Express','Standard')
group by shipping_type

--5. do subscribed customers spend more ? compare average spend and 
--total revenue btw subcribers and non-subscribers

select subscription_status, round(AVG(purchase_amount),2) as average_spent ,
round(SUM(purchase_amount),2) as total_revenue from customer 
group by subscription_status order by average,total desc

--6. which 5 products have the highest % of purchased with discount applied?

select item_purchased,
round(100 * sum(case when discount_applied= 'Yes' then 1 else 0 end)/count(*),2)
as percentages from customer
group by item_purchased order by percentages desc limit 5

--7. segment customer into new,returning ,loyal based on their total number of 
--previous_purchase and show the count of the segment

with customer_type as(
select customer_id,previous_purchases,
	CASE
		WHEN previous_purchases =1 then 'New'
		WHEN previous_purchases between 2 and 10 then 'Returning'
		ELSE 'Loyal' 
	end as segment 
from customer
)

select segment,count(*) from customer_type 
group by segment

--8 are the customers who are repeat buyers ( more than 5 previous purchases) also likelt to subcribe ?
select subscription_status,
count(*) as repeated_buyers 
from customer where previous_purchases > 5
group by subscription_status

--9 what is the revenue contributed of each age group ?

select age_group,sum(purchase_amount) as total_revenue
from customer group by age_group order by total_revenue desc

after tis imported the dataset from postgres to powerbi 

created three new measure for 
number of customer 
average review rating 
average purchase amount 

and created beatuifull power bi dashboard 
